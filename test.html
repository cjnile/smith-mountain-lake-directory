<!DOCTYPE html>
<html>
<head>
	<title>New Places API Test</title>
</head>
<body>
	<h1>Google Places API Test (New API)</h1>
	<button onclick="testNewAPI()">Test New Places API</button>
	<div id="result"></div>
	<div id="map" style="height:400px;width:100%;margin-top:20px;"></div>
	
	<script>
		(g=>{var h,a,k,p="The Google Maps JavaScript API",c="google",l="importLibrary",q="__ib__",m=document,b=window;b=b[c]||(b[c]={});var d=b.maps||(b.maps={}),r=new Set,e=new URLSearchParams,u=()=>h||(h=new Promise(async(f,n)=>{await (a=m.createElement("script"));e.set("libraries",[...r]+"");for(k in g)e.set(k.replace(/[A-Z]/g,t=>"_"+t[0].toLowerCase()),g[k]);e.set("callback",c+".maps."+q);a.src=`https://maps.googleapis.com/maps/api/js?`+e;d[q]=f;a.onerror=()=>h=n(Error(p+" could not load."));a.nonce=m.querySelector("script[nonce]")?.nonce||"";m.head.append(a)}));d[l]?console.warn(p+" only loads once. Ignoring:",g):d[l]=(f,...n)=>r.add(f)&&u().then(()=>d[l](f,...n))})({
			key: "AIzaSyCrj5ydDKjMGJN75Pe6sIdUyfh0dUCOMes",
			v: "weekly",
		});
		
		async function testNewAPI() {
			document.getElementById('result').innerHTML = 'Loading new API...';
			
			try {
				const { Map } = await google.maps.importLibrary("maps");
				const { Place } = await google.maps.importLibrary("places");
				
				const map = new Map(document.getElementById('map'), {
					center: {lat: 37.0389, lng: -79.5847},
					zoom: 12,
					mapId: 'DEMO_MAP_ID'
				});
				
				document.getElementById('result').innerHTML = 'Map loaded, searching for restaurants...';
				
				const request = {
					textQuery: 'restaurants near Smith Mountain Lake Virginia',
					fields: ['displayName', 'formattedAddress', 'location'],
					maxResultCount: 20
				};
				
				const { places } = await Place.searchByText(request);
				
				if (places && places.length > 0) {
					document.getElementById('result').innerHTML = 'SUCCESS! Found ' + places.length + ' restaurants:<br>';
					places.slice(0, 5).forEach(place => {
						document.getElementById('result').innerHTML += '- ' + place.displayName + '<br>';
					});
				} else {
					document.getElementById('result').innerHTML = 'No results found';
				}
				
			} catch (error) {
				document.getElementById('result').innerHTML = 'ERROR: ' + error.message;
				console.error('Full error:', error);
			}
		}
	</script>
</body>
</html>